<UserControl x:Class="SistemaJuridico.Views.ProcessoListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <Style TargetType="Button">
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Margin" Value="3"/>
            <Setter Property="Background" Value="#4F46E5"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#4F46E5"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
    </UserControl.Resources>

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" BorderBrush="#E5E7EB" BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,0,0,8" Background="#FFF8FAFC">
            <DockPanel LastChildFill="True">
                <TextBlock DockPanel.Dock="Left" Text="Pesquisar e selecionar processo" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,12,0"/>
                <WrapPanel DockPanel.Dock="Right" HorizontalAlignment="Right">
                    <Button Content="Novo Processo" Command="{Binding NovoProcessoCommand}"/>
                    <Button Content="Atualizar" Command="{Binding CarregarCommand}"/>
                    <Button Content="Busca avançada" Command="{Binding ToggleBuscaAvancadaCommand}"/>
                    <Button Content="Exportar" Command="{Binding ExportarResultadosCommand}"/>
                </WrapPanel>
            </DockPanel>
        </Border>

        <Border Grid.Row="1" BorderBrush="#E5E7EB" BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,0,0,8">
            <StackPanel>
                <DockPanel Margin="0,0,0,6" LastChildFill="True">
                    <TextBlock DockPanel.Dock="Left" Text="Busca simples:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                        <Button Content="Buscar" Width="100" Command="{Binding BuscarCommand}"/>
                        <Button Content="Limpar" Width="100" Background="#64748B" BorderBrush="#64748B" Command="{Binding LimparFiltrosCommand}"/>
                    </StackPanel>
                    <TextBox MinWidth="280" Text="{Binding TextoBusca, UpdateSourceTrigger=PropertyChanged}"/>
                </DockPanel>

                <StackPanel Visibility="{Binding MostrarBuscaAvancada, Converter={StaticResource BoolToVis}}">
                    <WrapPanel>
                        <StackPanel Width="190" Margin="0,0,10,6">
                            <TextBlock Text="Status"/>
                            <TextBox Text="{Binding StatusFiltro, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel Width="190" Margin="0,0,10,6">
                            <TextBlock Text="Tipo"/>
                            <TextBox Text="{Binding TipoFiltro, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel Width="190" Margin="0,0,10,6">
                            <TextBlock Text="Responsável"/>
                            <TextBox Text="{Binding ResponsavelFiltro, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel Width="140" Margin="0,0,10,6">
                            <TextBlock Text="Saldo mín."/>
                            <TextBox Text="{Binding ValorMinimo, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel Width="140" Margin="0,0,10,6">
                            <TextBlock Text="Saldo máx."/>
                            <TextBox Text="{Binding ValorMaximo, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel Width="220" Margin="0,0,10,6">
                            <TextBlock Text="Palavra-chave"/>
                            <TextBox Text="{Binding PalavraChaveHistorico, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </WrapPanel>
                    <TextBlock Text="{Binding ResumoEstatistico}" FontStyle="Italic" Opacity="0.8"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding Processos}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  SelectedItem="{Binding ProcessoSelecionado}"
                  MouseDoubleClick="DataGrid_MouseDoubleClick">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Número" Binding="{Binding Numero}" Width="150"/>
                <DataGridTextColumn Header="Paciente" Binding="{Binding Paciente}" Width="2*"/>
                <DataGridTextColumn Header="Genitor" Binding="{Binding Genitor}" Width="*"/>
                <DataGridTextColumn Header="Juiz" Binding="{Binding Juiz}" Width="*"/>
                <DataGridTextColumn Header="Tipo" Binding="{Binding TipoProcesso}" Width="*"/>
                <DataGridTextColumn Header="Status" Binding="{Binding StatusCalculado}" Width="*"/>
                <DataGridTextColumn Header="Saldo" Binding="{Binding Saldo, StringFormat=R$ {0:N2}}" Width="140"/>
                <DataGridTemplateColumn Header="Ação" Width="110">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="Abrir" Command="{Binding DataContext.AbrirProcessoCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
            <TextBlock Text="{Binding TotalResultados, StringFormat=Resultados: {0}}" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <Button Content="&lt;" Width="30" Command="{Binding PaginaAnteriorCommand}"/>
            <TextBlock Text="{Binding PaginaAtual}" VerticalAlignment="Center" Margin="8,0"/>
            <TextBlock Text="/" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <TextBlock Text="{Binding TotalPaginas}" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <Button Content=">" Width="30" Command="{Binding ProximaPaginaCommand}" Background="#64748B" BorderBrush="#64748B"/>
        </StackPanel>
    </Grid>
</UserControl>
